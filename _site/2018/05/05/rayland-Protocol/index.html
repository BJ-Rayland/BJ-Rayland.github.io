
<ul id="markdown-toc">
  <li><a href="#鸵鸟机器人控制协议" id="markdown-toc-鸵鸟机器人控制协议">鸵鸟机器人控制协议</a></li>
</ul>

<p>本文档介绍了用<code class="highlighter-rouge">Rayland-DUAL</code>主板控制鸵鸟机器人的控制协议。</p>

<h2 id="鸵鸟机器人控制协议">鸵鸟机器人控制协议</h2>

<p><code class="highlighter-rouge">Android -&gt; 下位机</code></p>

<p>1.1 <strong>控制指令</strong></p>

<p><code class="highlighter-rouge">cmd_type,pkg_length,seq,cmd_io,s_x,s_y,v_x,v_y</code></p>

<table>
  <thead>
    <tr>
      <th>Param</th>
      <th style="text-align: center">Describe</th>
      <th style="text-align: center">Type</th>
      <th style="text-align: center">Range</th>
      <th style="text-align: right">Unit</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>cmd_type</td>
      <td style="text-align: center">指令类型</td>
      <td style="text-align: center">uint8</td>
      <td style="text-align: center">0</td>
      <td style="text-align: right"> </td>
    </tr>
    <tr>
      <td>pkg_length</td>
      <td style="text-align: center">包长度</td>
      <td style="text-align: center">uint8</td>
      <td style="text-align: center"><code class="highlighter-rouge">12bytes</code></td>
      <td style="text-align: right"> </td>
    </tr>
    <tr>
      <td>seq</td>
      <td style="text-align: center">指令序号</td>
      <td style="text-align: center">uint8</td>
      <td style="text-align: center"> </td>
      <td style="text-align: right"> </td>
    </tr>
    <tr>
      <td>cmd_io</td>
      <td style="text-align: center">io口控制指令（8）</td>
      <td style="text-align: center">uint8</td>
      <td style="text-align: center"><code class="highlighter-rouge">0;1</code></td>
      <td style="text-align: right"> </td>
    </tr>
    <tr>
      <td>s_x</td>
      <td style="text-align: center">左轮里程</td>
      <td style="text-align: center">int16</td>
      <td style="text-align: center">打点个数</td>
      <td style="text-align: right"> </td>
    </tr>
    <tr>
      <td>s_y</td>
      <td style="text-align: center">右轮里程</td>
      <td style="text-align: center">int16</td>
      <td style="text-align: center">打点个数</td>
      <td style="text-align: right"> </td>
    </tr>
    <tr>
      <td>v_x</td>
      <td style="text-align: center">左轮速度</td>
      <td style="text-align: center">int16</td>
      <td style="text-align: center"><code class="highlighter-rouge">正:前进;负:后退</code></td>
      <td style="text-align: right"> </td>
    </tr>
    <tr>
      <td>v_y</td>
      <td style="text-align: center">右轮速度</td>
      <td style="text-align: center">int16</td>
      <td style="text-align: center">和<code class="highlighter-rouge">v_x</code>一致</td>
      <td style="text-align: right"> </td>
    </tr>
  </tbody>
</table>

<p>2.2 <strong>摄像头控制指令</strong></p>

<p><code class="highlighter-rouge">cmd_type,pkg_length,seq,angle_hor,angle_ver</code></p>

<table>
  <thead>
    <tr>
      <th>Param</th>
      <th style="text-align: center">Describe</th>
      <th style="text-align: center">Type</th>
      <th style="text-align: center">Range</th>
      <th style="text-align: right">Unit</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>cmd_type</td>
      <td style="text-align: center">指令类型</td>
      <td style="text-align: center">uint8</td>
      <td style="text-align: center">1</td>
      <td style="text-align: right"> </td>
    </tr>
    <tr>
      <td>pkg_length</td>
      <td style="text-align: center">包长度</td>
      <td style="text-align: center">uint8</td>
      <td style="text-align: center"><code class="highlighter-rouge">7bytes</code></td>
      <td style="text-align: right"> </td>
    </tr>
    <tr>
      <td>seq</td>
      <td style="text-align: center">指令序号</td>
      <td style="text-align: center">uint8</td>
      <td style="text-align: center"> </td>
      <td style="text-align: right"> </td>
    </tr>
    <tr>
      <td>angle_hor</td>
      <td style="text-align: center">水平方向转动角度</td>
      <td style="text-align: center">int16</td>
      <td style="text-align: center"><code class="highlighter-rouge">-180~180</code></td>
      <td style="text-align: right">°</td>
    </tr>
    <tr>
      <td>angle_ver</td>
      <td style="text-align: center">垂直方向转动角度</td>
      <td style="text-align: center">int16</td>
      <td style="text-align: center"><code class="highlighter-rouge">-180~180</code></td>
      <td style="text-align: right">°</td>
    </tr>
  </tbody>
</table>

<p>3.3 <strong>腰、升降控制指令</strong></p>

<p><code class="highlighter-rouge">cmd_type,pkg_length,seq,s_w,s_u</code></p>

<table>
  <thead>
    <tr>
      <th>Param</th>
      <th style="text-align: center">Describe</th>
      <th style="text-align: center">Type</th>
      <th style="text-align: right">Range</th>
      <th style="text-align: right">Unit</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>cmd_type</td>
      <td style="text-align: center">指令类型</td>
      <td style="text-align: center">uint8</td>
      <td style="text-align: right">2</td>
      <td style="text-align: right"> </td>
    </tr>
    <tr>
      <td>pkg_length</td>
      <td style="text-align: center">包长度</td>
      <td style="text-align: center">uint8</td>
      <td style="text-align: right"><code class="highlighter-rouge">7bytes</code></td>
      <td style="text-align: right"> </td>
    </tr>
    <tr>
      <td>seq</td>
      <td style="text-align: center">指令序号</td>
      <td style="text-align: center">uint8</td>
      <td style="text-align: right"> </td>
      <td style="text-align: right"> </td>
    </tr>
    <tr>
      <td>s_w</td>
      <td style="text-align: center">转腰里程</td>
      <td style="text-align: center">int16</td>
      <td style="text-align: right"> </td>
      <td style="text-align: right"> </td>
    </tr>
    <tr>
      <td>s_u</td>
      <td style="text-align: center">升降里程</td>
      <td style="text-align: center">int16</td>
      <td style="text-align: right"> </td>
      <td style="text-align: right"> </td>
    </tr>
  </tbody>
</table>

<p>4.4 <strong>out口控制指令</strong></p>

<p><code class="highlighter-rouge">cmd_type,pkg_length,seq,outputBit,maskBit</code></p>

<table>
  <thead>
    <tr>
      <th>Param</th>
      <th style="text-align: center">Describe</th>
      <th style="text-align: center">Type</th>
      <th style="text-align: right">Range</th>
      <th style="text-align: right">Unit</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>cmd_type</td>
      <td style="text-align: center">指令类型</td>
      <td style="text-align: center">uint8</td>
      <td style="text-align: right">3</td>
      <td style="text-align: right"> </td>
    </tr>
    <tr>
      <td>pkg_length</td>
      <td style="text-align: center">包长度</td>
      <td style="text-align: center">uint8</td>
      <td style="text-align: right"><code class="highlighter-rouge">7bytes</code></td>
      <td style="text-align: right"> </td>
    </tr>
    <tr>
      <td>seq</td>
      <td style="text-align: center">指令序号</td>
      <td style="text-align: center">uint8</td>
      <td style="text-align: right"> </td>
      <td style="text-align: right"> </td>
    </tr>
    <tr>
      <td>outputBit</td>
      <td style="text-align: center">输出</td>
      <td style="text-align: center">int16</td>
      <td style="text-align: right">0:move,1:stop</td>
      <td style="text-align: right"> </td>
    </tr>
    <tr>
      <td>maskBit</td>
      <td style="text-align: center">mask</td>
      <td style="text-align: center">int16</td>
      <td style="text-align: right">1:有效</td>
      <td style="text-align: right"> </td>
    </tr>
  </tbody>
</table>

<p><code class="highlighter-rouge">outputbit:</code>右转，左转，二右转，二左转，降，升，后退，后退</p>

<p>5.5 <strong>清空脉冲计数指令</strong></p>

<p><code class="highlighter-rouge">cmd_type,pkg_length,seq</code></p>

<table>
  <thead>
    <tr>
      <th>Param</th>
      <th style="text-align: center">Describe</th>
      <th style="text-align: center">Type</th>
      <th style="text-align: right">Range</th>
      <th style="text-align: right">Unit</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>cmd_type</td>
      <td style="text-align: center">指令类型</td>
      <td style="text-align: center">uint8</td>
      <td style="text-align: right">4</td>
      <td style="text-align: right"> </td>
    </tr>
    <tr>
      <td>pkg_length</td>
      <td style="text-align: center">包长度</td>
      <td style="text-align: center">uint8</td>
      <td style="text-align: right"><code class="highlighter-rouge">3bytes</code></td>
      <td style="text-align: right"> </td>
    </tr>
    <tr>
      <td>seq</td>
      <td style="text-align: center">指令序号</td>
      <td style="text-align: center">uint8</td>
      <td style="text-align: right"> </td>
      <td style="text-align: right"> </td>
    </tr>
  </tbody>
</table>

<p><code class="highlighter-rouge">下位机 -&gt; Android</code></p>

<p>1.1 <strong>状态回传</strong></p>

<p><code class="highlighter-rouge">cmd_type,pkg_length,seq,lim,pro_change,pulse_count</code></p>

<table>
  <thead>
    <tr>
      <th>Param</th>
      <th style="text-align: center">Describe</th>
      <th style="text-align: center">Type</th>
      <th style="text-align: right">Range</th>
      <th style="text-align: right">Unit</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>cmd_type</td>
      <td style="text-align: center">指令类型</td>
      <td style="text-align: center">uint8</td>
      <td style="text-align: right">0</td>
      <td style="text-align: right"> </td>
    </tr>
    <tr>
      <td>pkg_length</td>
      <td style="text-align: center">包长度</td>
      <td style="text-align: center">uint8</td>
      <td style="text-align: right"><code class="highlighter-rouge">24bytes</code></td>
      <td style="text-align: right"> </td>
    </tr>
    <tr>
      <td>seq</td>
      <td style="text-align: center">指令序号</td>
      <td style="text-align: center">uint8</td>
      <td style="text-align: right"> </td>
      <td style="text-align: right"> </td>
    </tr>
    <tr>
      <td>lim</td>
      <td style="text-align: center">限位开关信息（15）</td>
      <td style="text-align: center">uint32</td>
      <td style="text-align: right"><code class="highlighter-rouge">0;1</code></td>
      <td style="text-align: right"> </td>
    </tr>
    <tr>
      <td>pro</td>
      <td style="text-align: center">优先级控制</td>
      <td style="text-align: center">uint8</td>
      <td style="text-align: right"> </td>
      <td style="text-align: right"> </td>
    </tr>
    <tr>
      <td>pulse_count</td>
      <td style="text-align: center">脉冲计数（4）</td>
      <td style="text-align: center">uint32 * 4</td>
      <td style="text-align: right"> </td>
      <td style="text-align: right"> </td>
    </tr>
  </tbody>
</table>

<p><code class="highlighter-rouge">lim:</code></p>

<table>
  <thead>
    <tr>
      <th> </th>
      <th>‭</th>
      <th> </th>
      <th> </th>
      <th> </th>
      <th> </th>
      <th> </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>正常</td>
      <td>0000 0000‭0001 11111010‬</td>
      <td>506</td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>后到位</td>
      <td>0000 0000‭‭0001 11101010‬</td>
      <td>490</td>
      <td>5-0-15</td>
      <td>停</td>
      <td>15-0</td>
      <td>中</td>
    </tr>
    <tr>
      <td>下降</td>
      <td>0000 0000‭0001 11111110‬</td>
      <td>510</td>
      <td>3-1-17</td>
      <td>停</td>
      <td>17-1</td>
      <td>中</td>
    </tr>
    <tr>
      <td>上升</td>
      <td>‭0000 0000‭0001 11111011‬</td>
      <td>507</td>
      <td>1-1-19</td>
      <td>停</td>
      <td>19-1</td>
      <td>中</td>
    </tr>
    <tr>
      <td>中间点</td>
      <td>0000 0000‭0001 01111010‬‬</td>
      <td>378</td>
      <td>8-0-12</td>
      <td> </td>
      <td>12-0</td>
      <td>0</td>
    </tr>
    <tr>
      <td>正转</td>
      <td>0000 0000‭‭0101 11111010‬</td>
      <td>1530</td>
      <td>11-1-9</td>
      <td>停</td>
      <td>9-1</td>
      <td>中</td>
    </tr>
    <tr>
      <td>反转</td>
      <td>0000 0000‭‭1011 11111010‬</td>
      <td>3066</td>
      <td>12-1-8</td>
      <td>停</td>
      <td>8-1</td>
      <td>中</td>
    </tr>
    <tr>
      <td>云台上</td>
      <td>‭0001 00000001 11111010‬</td>
      <td>66042</td>
      <td>17-1-3</td>
      <td> </td>
      <td>3-1</td>
      <td>中</td>
    </tr>
    <tr>
      <td>云台下</td>
      <td>‭‭0010 00000001 11111010‬</td>
      <td>131578</td>
      <td>18-1-2</td>
      <td> </td>
      <td>2-1</td>
      <td>中</td>
    </tr>
    <tr>
      <td>云台左</td>
      <td>‭0000 10000001 11111010‬</td>
      <td>33274</td>
      <td>16-1-4</td>
      <td> </td>
      <td>4-1</td>
      <td>中</td>
    </tr>
    <tr>
      <td>云台右</td>
      <td>0000 ‭01000001 11111010‬</td>
      <td>16890</td>
      <td>15-1-5</td>
      <td> </td>
      <td>5-1</td>
      <td>中</td>
    </tr>
  </tbody>
</table>

<p>​</p>

<p>​</p>

<table>
  <thead>
    <tr>
      <th> </th>
      <th>‭</th>
      <th> </th>
      <th> </th>
      <th> </th>
      <th> </th>
      <th> </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>中间点</td>
      <td>‭0000 00000011 01001<strong>0</strong>11‬</td>
      <td>0 不正常1</td>
      <td> </td>
      <td>843</td>
      <td>17</td>
      <td>0</td>
    </tr>
    <tr>
      <td>正常</td>
      <td>‭0000 00000011 01001111‬</td>
      <td> </td>
      <td> </td>
      <td>847</td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>后到位</td>
      <td>0000 0000‭00<strong>0</strong>1 01001011‬</td>
      <td> </td>
      <td> </td>
      <td>331 停</td>
      <td>10-0</td>
      <td>中</td>
    </tr>
    <tr>
      <td>下降</td>
      <td>0000 0000‭0011 <strong>1</strong>1001011‬</td>
      <td> </td>
      <td> </td>
      <td>停</td>
      <td>12-1</td>
      <td>中</td>
    </tr>
    <tr>
      <td>上升</td>
      <td>0000 0000‭‭0011 01<strong>1</strong>01011‬</td>
      <td> </td>
      <td> </td>
      <td>停</td>
      <td>14-1</td>
      <td>中</td>
    </tr>
    <tr>
      <td>正转</td>
      <td>0000 0000‬‭0<strong>1</strong>11 01001111‬</td>
      <td> </td>
      <td> </td>
      <td>1871停</td>
      <td>9-1</td>
      <td>中</td>
    </tr>
    <tr>
      <td>反转</td>
      <td>0000 0000‭<strong>1</strong>011 01011111‬</td>
      <td> </td>
      <td> </td>
      <td>停</td>
      <td>8-1</td>
      <td>中</td>
    </tr>
    <tr>
      <td>云台上</td>
      <td>‭‭00<strong>1</strong>0 00000011 01001011‬</td>
      <td> </td>
      <td> </td>
      <td>131915</td>
      <td>2-1</td>
      <td>中 左转 右转</td>
    </tr>
    <tr>
      <td>云台下</td>
      <td>‭000<strong>1</strong> 00000011 01001011‬</td>
      <td> </td>
      <td> </td>
      <td>66379</td>
      <td>3-1</td>
      <td>中</td>
    </tr>
    <tr>
      <td>云台左</td>
      <td>0000 ‭0<strong>1</strong>000011 01001011‬</td>
      <td> </td>
      <td> </td>
      <td>17227</td>
      <td>5-1</td>
      <td>中</td>
    </tr>
    <tr>
      <td>云台右</td>
      <td>0000 <strong>‭1</strong>0000011 01001011‬</td>
      <td> </td>
      <td> </td>
      <td>33611</td>
      <td>4-1</td>
      <td>中</td>
    </tr>
  </tbody>
</table>

<p>​</p>

